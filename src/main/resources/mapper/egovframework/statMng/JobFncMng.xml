<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.com.stat.dao.JobFncDao">

	<!-- Maria -->
    <select id="selectJobFncList"  parameterType="Map" resultType="hashMap">
		SELECT 	SERVER_ID as "serverId"
				, HOSTNAME as "hostName"
				, LFNC_NM as "lFncNm"
				, MFNC_NM as "mFncNm"
				, SFNC_NM as "sFncNm"
				, DETAIL_FNC_NM as "detailFncNm"
				, METHOD_NM as "methodNm"
				, FRST_REGISTER_ID as "frstRegisterId"
				, FRST_REGIST_PNTTM as "frstRegistPnttm"
				, LAST_UPDUSR_ID as "lastUpdUsr"
				, LAST_UPDT_PNTTM as "lastUpdtPnttm"
		FROM COMTJOBFNCLIST
	</select>

	<select id="selectJobFncDetail"  parameterType="Map" resultType="hashMap">
		SELECT 	SERVER_ID as "serverId"
				, HOSTNAME as "hostName"
				, LFNC_NM as "lFncNm"
				, MFNC_NM as "mFncNm"
				, SFNC_NM as "sFncNm"
				, DETAIL_FNC_NM as "detailFncNm"
				, METHOD_NM as "methodNm"
				, FRST_REGISTER_ID as "frstRegisterId"
				, FRST_REGIST_PNTTM as "frstRegistPnttm"
				, LAST_UPDUSR_ID as "lastUpdUsr"
				, LAST_UPDT_PNTTM as "lastUpdtPnttm"
		FROM COMTJOBFNCLIST
		WHERE SERVER_ID = '${SERVER_ID}'
	</select>

	<select id="selectJobFncMethod"  parameterType="Map" resultType="hashMap">
		SELECT 	SERVER_ID as "serverId"
		, HOSTNAME as "hostName"
		, LFNC_NM as "lFncNm"
		, MFNC_NM as "mFncNm"
		, SFNC_NM as "sFncNm"
		, DETAIL_FNC_NM as "detailFncNm"
		, METHOD_NM as "methodNm"
		, FRST_REGISTER_ID as "frstRegisterId"
		, FRST_REGIST_PNTTM as "frstRegistPnttm"
		, LAST_UPDUSR_ID as "lastUpdUsr"
		, LAST_UPDT_PNTTM as "lastUpdtPnttm"
		FROM COMTJOBFNCLIST
		WHERE METHOD_NM = '${METHOD_NM}'
	</select>

	<insert id="insertJobFncDetail" parameterType="hashMap">
	INSERT INTO COMTJOBFNCLIST (
		SERVER_ID
		, HOSTNAME
		, LFNC_NM
		, MFNC_NM
		, SFNC_NM
		, DETAIL_FNC_NM
		, METHOD_NM
		, FRST_REGISTER_ID
		, FRST_REGIST_PNTTM
		, LAST_UPDUSR_ID
		, LAST_UPDT_PNTTM
		) VALUES (
		  #{SERVER_ID}
		, #{HOSTNAME}
		, #{LFNC_NM}
		, #{MFNC_NM}
		, #{SFNC_NM}
		, #{DETAIL_FNC_NM}
		, #{METHOD_NM}
		, #{FRST_REGISTER_ID}
		, DATE_FORMAT(CURRENT_TIMESTAMP, '%Y%m%d%H%i%s')
		, #{LAST_UPDUSR_ID}
		, DATE_FORMAT(CURRENT_TIMESTAMP, '%Y%m%d%H%i%s')
	)
	</insert>

	<update id="updateJobFncDetail" parameterType="hashMap">
	UPDATE COMTJOBFNCLIST
		SET LAST_UPDT_PNTTM = DATE_FORMAT(CURRENT_TIMESTAMP, '%Y%m%d%H%i%s')
		<if test='HOSTNAME != null'> , HOSTNAME              	= '${HOSTNAME}' </if>
		<if test='LFNC_NM != null'> , LFNC_NM       = '${LFNC_NM}' </if>
		<if test='MFNC_NM != null'> , MFNC_NM            		= '${MFNC_NM}' </if>
		<if test='SFNC_NM != null'> , SFNC_NM              	= '${SFNC_NM}' </if>
		<if test='DETAIL_FNC_NM != null'> , DETAIL_FNC_NM              		= '${DETAIL_FNC_NM}' </if>
		<if test='METHOD_NM != null'> , METHOD_NM              	= '${METHOD_NM}' </if>
		WHERE SERVER_ID           = '${SERVER_ID}'
	</update>


	<delete id="deleteJobFnc" parameterType="hashMap">
		DELETE FROM COMTJOBFNCLIST
		WHERE SERVER_ID           = '${SERVER_ID}'
	</delete>

</mapper> 