<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.com.stat.dao.UserStatDao">

	<!-- Maria -->
    <select id="selectUserStatList"  parameterType="Map" resultType="hashMap">

		SELECT 	ID as "id"
				, OCCRRNC_DT as "occrrncDt"
				, HOSTNAME as "hostName"
				, USR_ID as "usrId"
		FROM COMTSUSERSTAT

	</select>

	<select id="selectActiveUserList"  parameterType="Map" resultType="hashMap">

		SELECT OCCRRNC_DT as "occrrncDt"
		, HOSTNAME as "hostName"
		, COUNT(USR_ID) as "usrCnt"
		FROM COMTSUSERSTAT
		WHERE 1=1
		AND OCCRRNC_DT BETWEEN '${STARTDT}' AND '${ENDDT}'
		GROUP BY OCCRRNC_DT, HOSTNAME

	</select>
	
	<select id="selectUserMonthStatList"  parameterType="Map" resultType="hashMap">

		SELECT LEFT(OCCRRNC_DT,6) as "occrrncMonth"
		, HOSTNAME as "hostName"
		, COUNT(USR_ID) as "usrCnt"
		FROM COMTSUSERSTAT
		WHERE 1=1
		GROUP BY LEFT(OCCRRNC_DT,6) , HOSTNAME

	</select>

	<insert id="insertUserStat" parameterType="hashMap">
		INSERT INTO COMTSUSERSTAT (
			ID
			, OCCRRNC_DT
			, HOSTNAME
			, USR_ID
		) VALUES (
			NEXT VALUE FOR Seq_UserStat
			, #{OCCRRNC_DT}
			, #{HOSTNAME}
			, #{USR_ID}
		)
	</insert>

</mapper> 